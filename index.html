<head>

	<!-- stylesheets -->
	<link rel="stylesheet" type="text/css" href="css/index.css">
	<link rel="stylesheet" type="text/css" href="css/companyTrendVis.css">
	<link rel="stylesheet" type="text/css" href="css/companyCompareVis.css">
	<link rel="stylesheet" type="text/css" href="css/postStyling.css">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/css/materialize.min.css">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


	<!-- libraries -->
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/js/materialize.min.js"></script>

	<!-- include scripts for viz -->
	<script src="js/sentimentBarGraphVis.js"></script>
	<script src="js/companyTrendVis.js"></script>
	<script src="js/topPosts.js"></script>
	<script src="js/companyCompareVis.js"></script>

</head>
<body>

	<!-- div for main content, centered in wrapper -->
	<div id = "wrapper">
        
		<div class="card blue-grey darken-1 barvis z-depth-5" id="sentimentBarGraph">
			<div class = "card-content">
				<span class="card-title">Sentiment Analysis Bar Graph</span>
				<div id = "content"></div>
			</div>
		</div>

		<!-- card for specific company content -->
		<div id="companyPage">				
			<div class="card-action">
	              <a class="waves-effect waves-light btn" id="backButton">back to home</a>
	            </div>
	        <div class="row">
				<div class="col s7 card blue-grey darken-1 z-depth-5" id="companyCard">
					<div class = "card-content">
						<span class="card-title" id='companyTitle'>Company Card</span>

						<!-- div for the line graph -->
						<div id = "companyTrendVis"></div>

						<!-- div for the top influencer posts -->
						<div id="topPosts"></div>
					</div>

				</div>

				<!-- card for the top posts -->
				<div class="col s3 card blue-grey darken-1 z-depth-5" id="companyPosts">
					<span class="card-title" id='postsTitle'>Top Posts</span>
				</div>	
			</div>

			<!-- card for the comparison -->
			<div class="row">
				<div class="card col s8 blue-grey darken-1 z-depth-5" id="companyCompare">

				<div class="input-field col s4">
					<select id="companyCompareSelect" onchange="companySelect()">
						<option value="" disabled selected>Choose a company</option>
						<option value="1">Option 1</option>
						<option value="2">Option 2</option>
						<option value="3">Option 3</option>
					</select>
					<label>Select a company to compare trends</label>
				</div>

					<div id="companyCompareVis"></div>
				</div>		
			</div>


		</div>

	</div>

	<script>
		$(function(){

			// dummy data
			var sentimentData = [{'company': 'Facebook', 'score': 99}, 
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17},
						{'company': 'Google', 'score': 75}, 
						{'company': 'Dropbox', 'score': 24}, 
						{'company': 'Airbnb', 'score': 17}, 
						{'company': 'Uber', 'score': 51}, ];

			var companyData = [{'postDate': '2015-05', 'postSentimentScore': 99}, 
			{'postDate': '2015-06', 'postSentimentScore': 75},
			{'postDate': '2015-07', 'postSentimentScore': 24},
			{'postDate': '2015-08', 'postSentimentScore': 47},
			{'postDate': '2015-09', 'postSentimentScore': 89} ];

			var metaData = {};

			// Create an eventHandler
            var MyEventHandler = new Object();

            // instantiate vis objects
            var sentiment_bar_vis = new SentimentBarVis(d3.select("#content"), sentimentData, metaData, MyEventHandler);
            var company_trend_vis = new CompanyTrendVis(d3.select("#companyTrendVis"), companyData, metaData, MyEventHandler);
            var company_compare_vis = new CompanyCompareVis(d3.select('#companyCompareVis'), companyData, metaData, MyEventHandler);

            $('select').material_select();

            // bind eventHandler to vis objects
            // listener for a specific company selected from graph
            $(MyEventHandler).bind("selectCompany", function(event, company){

            	company_trend_vis.onSelectionChange(company);

            	// find and add the top posts for this company
				addPosts(dummyData);
            })

            $('#backButton').on('click', function(){

				$('#sentimentBarGraph').toggleClass('transitionLeftOut');
				$('#companyPage').toggleClass('transitionRightIn');

            });
		})

		function companySelect(){

			var selectedCompany = $('#companyCompareSelect').val();
			console.log(selectedCompany);
		}
	</script>
</body>